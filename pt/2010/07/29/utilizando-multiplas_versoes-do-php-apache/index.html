<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"><title>Utilizando múltiplas versões do PHP + Apache | Rafael Kassner</title><meta name="robots" content="index,follow"/><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.kassner.com.br/atom.xml"/><link rel="canonical" href="https://www.kassner.com.br/pt/2010/07/29/utilizando-multiplas_versoes-do-php-apache/"/><link rel="stylesheet" href="https://www.kassner.com.br/assets/css/main.css"/></head><body class="post"><div class="background"></div><div id="wrapper"> <header> <nav id="site-navigation" class="main-navigation" role="navigation"> <label for="drop" class="toggle">Menu</label> <input type="checkbox" id="drop"/><ul id="primary-menu" class="menu"><li class="menu-item"><a href="https://www.kassner.com.br">Rafael Kassner</a></li><li class="menu-item"><a href="https://www.kassner.com.br/projects/">Projects</a></li><li class="menu-item"><a href="https://www.kassner.com.br/about/">About</a></li></ul> </nav> </header><div class="pull-down"></div><div class="container"><div id="primary" class="content-area"> <main id="main" class="site-main" role="main"> <article lang="en" class="post type-post status-publish format-standard hentry"><h1 class="article-header"><a href="https://www.kassner.com.br/pt/2010/07/29/utilizando-multiplas_versoes-do-php-apache/">Utilizando múltiplas versões do PHP + Apache</a></h1><div class="entry-meta"><div class="byline"> <span class="posted-on"><time class="entry-date published" datetime="2010-07-29T00:00:00+00:00">2010-07-29</time></span> <span class="language">Português</span></div></div><div class="entry-content"><p>Olá.</p><p>Esta é uma dica para utilizar em ambiente de desenvolvimento e/ou testes, onde é necessário utilizar mais de uma versão do PHP, sem que seja necessário setar uma para todo seu ambiente. Neste caso, a versão será definida via .htaccess, porém, somente é possível utilizar esta técnica se você puder compilar o PHP.</p><p>É realmente importante pra quem precisa dar suporte a ambientes e/ou sistemas legadosm ou testar a retrocompatiblidade de um código PHP. Parto do princípio que você já saiba compilar o PHP para seu ambiente, se não souber, procure no Google antes.</p><h3 id="resumo">Resumo:</h3><p>No source do PHP, substitua todas as entradas abaixo:</p><table border="1"><tr><td>php5_module</td><td>php5_x_x_module</td></tr><tr><td>libphp5</td><td>libphp5.x.x</td></tr><tr><td>application/x-httpd-php</td><td>application/x-httpd-php-5-x-x</td></tr></table><p><br/></p><p>E compile normalmente. No PHP <code class="language-plaintext highlighter-rouge">5.3.x</code> pode ocorrer um erro informando que o <code class="language-plaintext highlighter-rouge">libs/libphp5.3.x.so</code> não foi encontrado, basta entrar na pasta libs e mover/copiar o libphp.so para <code class="language-plaintext highlighter-rouge">libphp5.3.x.so</code>.</p><h3 id="passo-a-passo">Passo-a-passo:</h3><p>Onde eu estiver especificando <code class="language-plaintext highlighter-rouge">5.x.x</code> ou <code class="language-plaintext highlighter-rouge">5_x_x</code>, isso significa a versão do PHP que você está compilando.</p><ul><li><p>Baixe o source do PHP e descompacte para um diretório de sua preferência.</p></li><li><p>Com o auxílio de um editor de texto (TextMate, Notepad++, DreamWeaver, etc), procure em todo o diretório do source (que você descompactou anteriormente), e substitua:</p></li></ul><table border="1"><tr><th>Procure por:</th><th>Substitua por:</th></tr><tr><td>php5_module</td><td>php5_x_x_module</td></tr><tr><td>libphp5</td><td>libphp5.x.x</td></tr><tr><td>application/x-httpd-php</td><td>application/x-httpd-php5-x-x</td></tr></table><p><br/></p><p>Se você está se perguntando o que isso faz: essas substituições fazem com que cada versão diferente do PHP que você vá compilar seja definida como um novo módulo no Apache, ao invés de sempre ser php5_module.</p><p>A alteração do MimeType (terceira substituição) serve para que você consiga chavear entre as versões via .htaccess, pois não podemos colocar um LoadModule no .htaccess.</p><ul><li><p>Compile sua versão do PHP normalmente, cada versão em um diretório separado.</p></li><li><p>Se você estiver compilando uma versão 5.3 do PHP, você pode receber um erro ao executar o comando make install, informando que o arquivo libs/libphp5.x.x.so não existe. Neste caso, basta copiar o arquivo libs/libphp5.so e tentar novamente.</p></li><li><p>Em alguns casos, o comando make install ativa o php5_module automaticamente no httpd.conf. Neste caso, revise o arquivo, pois em todas as minhas tentativas, por algum motivo obscuro, ele adicionava o módulo como o nome de php5_module, e não php5_x_x_module. Se isso acontecer, apenas renomeie o módulo.</p></li><li><p>Ainda é possível utilizar extensões dinamicamente no PHP, porém, você pode obter erros por estar usando uma extensão compilada para outra versão da qual você esteja rodando. Sugiro <a href="http://www.php.net/manual/en/install.pecl.static.php">compilar as extensões estaticamente</a>.</p></li><li><p>Sugiro cuidado ao definir a propriedade –with-config-file-path, para que o php.ini seja o diferente em várias versões do PHP. Você pode obter erros por definir alguma propriedade errada ou inexistente para uma versão específica do PHP.</p></li><li><p>Reinicie o Apache para as alterações terem efeito.</p></li><li><p>Para utilizar uma determinada versão (que você já compilou com este método) em um projeto no seu ambiente, basta adicionar a seguinte propriedade ao .htaccess do projeto:</p></li></ul><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AddType application/x-httpd-php5-x-x .php
</code></pre></div></div><p>Onde <code class="language-plaintext highlighter-rouge">5-x-x</code> é a versão do PHP que você deseja.</p><p>Dúvidas? Deixe um comentário.</p></div><div class="entry-footer"><p class="cat-links">Posted in <a href="/tags/php/" rel="tag">php</a>, <a href="/tags/apache/" rel="tag">apache</a>, <a href="/tags/ambiente-de-desenvolvimento/" rel="tag">ambiente de desenvolvimento</a></p></div> </article> </main></div></div></div><footer><div class="footer-content"></div><div class="footer"><div><div> <span class="copy">Copyright © 2010-2021 Rafael Kassner</span></div></div></div> </footer></body></html>