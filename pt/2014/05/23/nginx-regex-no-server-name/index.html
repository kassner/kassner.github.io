<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"><title>Nginx: regex no server_name | Rafael Kassner</title><meta name="robots" content="index,follow"/><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.kassner.com.br/atom.xml"/><link rel="canonical" href="https://www.kassner.com.br/pt/2014/05/23/nginx-regex-no-server-name/"/><link rel="stylesheet" href="https://www.kassner.com.br/assets/css/main.css"/></head><body class="post"><div class="background"></div><div id="wrapper"> <header> <nav id="site-navigation" class="main-navigation" role="navigation"> <label for="drop" class="toggle">Menu</label> <input type="checkbox" id="drop"/><ul id="primary-menu" class="menu"><li class="menu-item"><a href="https://www.kassner.com.br">Rafael Kassner</a></li><li class="menu-item"><a href="https://www.kassner.com.br/projects/">Projects</a></li><li class="menu-item"><a href="https://www.kassner.com.br/about/">About</a></li></ul> </nav> </header><div class="pull-down"></div><div class="container"><div id="primary" class="content-area"> <main id="main" class="site-main" role="main"> <article lang="en" class="post type-post status-publish format-standard hentry"><h1 class="article-header"><a href="https://www.kassner.com.br/pt/2014/05/23/nginx-regex-no-server-name/">Nginx: regex no server_name</a></h1><div class="entry-meta"><div class="byline"> <span class="posted-on"><time class="entry-date published" datetime="2014-05-23T00:00:00+00:00">2014-05-23</time></span> <span class="language">Português</span></div></div><div class="entry-content"><p>Pequena dica para utilizar expressões regulares na diretiva <a href="http://nginx.org/en/docs/http/server_names.html">server_name</a> do Nginx.</p><p>Usando um diretório específico para cada subdomínio:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server <span class="o">{</span>
    listen 80<span class="p">;</span>
    server_name ~^<span class="o">(</span>.<span class="k">*</span><span class="o">)</span><span class="se">\.</span>project<span class="se">\.</span>com<span class="nv">$;</span>
    root /home/www/project/<span class="nv">$1</span><span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div><p>Definindo uma variável de ambiente em um projeto único:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server <span class="o">{</span>
    listen 80<span class="p">;</span>
    server_name ~^<span class="o">(</span>.<span class="k">*</span><span class="o">)</span><span class="se">\.</span>project<span class="se">\.</span>com<span class="nv">$;</span>
    fastcgi_param CUSTOMER <span class="nv">$1</span><span class="p">;</span>
    root /home/www/project<span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div><p>Você também pode utilizar a expressão para o domínio todo:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server <span class="o">{</span>
    listen 80<span class="p">;</span>
    server_name ~^<span class="o">(</span>.<span class="k">*</span><span class="o">)</span><span class="se">\.</span><span class="o">(</span>.<span class="k">*</span><span class="se">\.</span>.<span class="k">*</span><span class="o">)</span><span class="nv">$;</span>
    root /home/www/<span class="nv">$2</span>/subdomains/<span class="nv">$1</span>/public_html<span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div><p>Testado no Nginx 1.4.x.</p></div><div class="entry-footer"><p class="cat-links">Posted in <a href="/tags/nginx/" rel="tag">nginx</a></p></div> </article> </main></div></div></div><footer><div class="footer-content"></div><div class="footer"><div><div> <span class="copy">Copyright © 2010-2021 Rafael Kassner</span></div></div></div> </footer></body></html>